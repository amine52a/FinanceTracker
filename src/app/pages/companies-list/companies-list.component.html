<app-sidebar></app-sidebar>
<div class="main-content">
  <div class="header-container">
    <div class="header-content">
      <h1>Company Directory</h1>
      <button mat-flat-button color="primary" class="add-button" routerLink="/companies/add">
        <mat-icon>add</mat-icon> Add Company
      </button>
    </div>
  </div>

  <div class="table-container mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- Image Column -->
      <ng-container matColumnDef="image">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let company">
          <div class="company-logo" [style.background-image]="'url(' + getCompanyImageUrl(company.images?.[0]) + ')'">
            <div class="logo-fallback" *ngIf="!company.images?.[0]">
              {{ company.name | initials }}
            </div>
          </div>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Company Name</th>
        <td mat-cell *matCellDef="let company">
          {{ company.name }}
        </td>
      </ng-container>

      <!-- Field Column -->
      <ng-container matColumnDef="field">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Industry</th>
        <td mat-cell *matCellDef="let company">
          {{ company.field }}
        </td>
      </ng-container>

      <!-- Workers Column -->
      <ng-container matColumnDef="numberOfWorkers">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Employees</th>
        <td mat-cell *matCellDef="let company">
          <div class="employee-count">
            <mat-icon>people</mat-icon>
            <span>{{ company.numberOfWorkers }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Created On Column -->
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Member Since</th>
        <td mat-cell *matCellDef="let company">
          <div class="date-cell">
            <mat-icon>event</mat-icon>
            <span>{{ company.createdAt | date: 'mediumDate' }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let company">
          <div class="action-buttons">
            <button mat-icon-button class="edit-btn" [routerLink]="['/companies/edit', company._id]">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button class="delete-btn" (click)="onDelete(company._id)">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-stroked-button class="details-btn" (click)="goToCompanyDetails(company._id)">
              <mat-icon>visibility</mat-icon>
              Details
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</div>